/**
 * Copyright (c) 2010 - 2012, Jason Mulligan <jason.mulligan@avoidwork.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of abaaso nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL JASON MULLIGAN BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/**
 * abaaso
 *
 * Events: init           Fires when abaaso is ready; register modules on this event
 *         ready          Fires when the DOM is available
 *         render         Fires when the window resources have loaded
 *         resize         Fires when the window resizes; parameter for listeners is abaaso.client.size
 *         afterCreate    Fires after an Element is created; parameter for listeners is the (new) Element
 *         afterDestroy   Fires after an Element is destroyed; parameter for listeners is the (removed) Element.id value
 *         beforeCreate   Fires when an Element is about to be created; parameter for listeners is the (new) Element.id value
 *         beforeDestroy  Fires when an Element is about to be destroyed; parameter for listeners is the (to be removed) Element
 *         error          Fires when an Error is caught; parameter for listeners is the logged Object (abaaso.error.log[n])
 *         beforeHash     Fires before the hash event
 *         hash           Fires when window.location.hash changes; parameter for listeners is the hash value
 *         afterHash      Fires after the hash event; parameter for listeners is the hash value
 *
 * @author Jason Mulligan <jason.mulligan@avoidwork.com>
 * @link http://abaaso.com/
 * @module abaaso
 * @version 1.9.9
 */
(function(a){var b=a.document,c=a.location,d=a.navigator;typeof a.$=="undefined"&&(a.$=null),typeof a.abaaso=="undefined"&&(a.abaaso=function(){"use strict";var e,f,g,h,i,j,k,l,m,o,p,q,r,s,t,u,v;return f={cast:function(a,b){if(!h.safari&&typeof a!="object"||h.safari&&typeof a!="function")throw Error(m.error.expectedObject);b=b===!0;var c=[],d,e;switch(!0){case!isNaN(a.length):!h.ie||h.version>8?c=Array.prototype.slice.call(a):a.each(function(a){c.push(a)});break;default:s.iterate(a,function(a,d){c.push(b?d:a)})}return c},clone:function(a){return s.clone(a)},contains:function(a,b){var c=[],d,e;return b=typeof b.indexOf=="function"?b.explode():[b],d=a.length,b.each(function(b){for(e=0;e<d;e++)b===a[e]&&c.push(e)}),c.sort(function(a,b){return a-b})},diff:function(a,b){var c=a.length>b.length?a:b,d=c===a?b:a;return c.filter(function(a){if(d.indexOf(a)===-1)return!0})},each:function(a,b){var c=0;return a.forEach(function(a){b(a,c++)}),a},first:function(a){return a[0]},index:function(a,b){return a.indexOf(b)},indexed:function(a){var b=[];return a.each(function(a,c){b.push(a instanceof Array?this[c].indexed():a)}),b},intersect:function(a,b){var c=a.length>b.length?a:b,d=c===a?b:a;return c.filter(function(a){if(d.indexOf(a)>-1)return!0})},keys:function(a){var b=[];return s.iterate(a,function(a,c){isNaN(c)&&b.push(c)}),b},last:function(a){var b=a.length;return b>1?a[b-1]:a.first()},remove:function(a,b,c){if(typeof b=="string"){b=a.index(b);if(b===-1)return a}else b=b||0;var d=a.length,e=a.slice((c||b)+1||d);return a.length=b<0?d+b:b,a.push.apply(a,e),a},total:function(a){return a.indexed().length},toObject:function(a){var b={},c=a.length;while(c--)b[c.toString()]=a[c];return b}},g={items:{},clean:function(){return s.iterate(g.items,function(a,b){g.expired(b)&&g.expire(b)})},expire:function(a,b){return b=b===!0,typeof g.items[a]!="undefined"?(delete g.items[a],b||a.fire("beforeExpire").fire("expire").fire("afterExpire"),!0):!1},expired:function(a){var b=g.items[a];return typeof b!="undefined"&&typeof b.expires!="undefined"&&b.expires<new Date},get:function(a,b){return b=b!==!1,typeof g.items[a]=="undefined"?!1:b&&g.expired(a)?(g.expire(a),!1):g.items[a]},set:function(a,b,c){return typeof g.items[a]=="undefined"&&(g.items[a]={},g.items[a].permission=0),b==="permission"?g.items[a].permission|=c:b==="!permission"?g.items[a].permission&=~c:g.items[a][b]=c,g.items[a]}},h={android:function(){return typeof d!="undefined"&&/android/i.test(d.userAgent)}(),blackberry:function(){return typeof d!="undefined"&&/blackberry/i.test(d.userAgent)}(),chrome:function(){return typeof d!="undefined"&&/chrome/i.test(d.userAgent)}(),css3:function(){switch(!0){case this.mobile:case this.tablet:case this.chrome&&this.version>5:case this.firefox&&this.version>2:case this.ie&&this.version>8:case this.opera&&this.version>8:case this.safari&&this.version>4:return this.css3=!0,!0;default:return this.css3=!1,!1}},expire:0,firefox:function(){return typeof d!="undefined"&&/firefox/i.test(d.userAgent)}(),ie:function(){return typeof d!="undefined"&&/msie/i.test(d.userAgent)}(),ios:function(){return typeof d!="undefined"&&/ipad|iphone/i.test(d.userAgent)}(),linux:function(){return typeof d!="undefined"&&/linux|bsd|unix/i.test(d.userAgent)}(),mobile:function(){return typeof d!="undefined"&&/android|blackberry|ipad|iphone|meego|webos/i.test(d.userAgent)}(),playbook:function(){return typeof d!="undefined"&&/playbook/i.test(d.userAgent)}(),opera:function(){return typeof d!="undefined"&&/opera/i.test(d.userAgent)}(),osx:function(){return typeof d!="undefined"&&/macintosh/i.test(d.userAgent)}(),safari:function(){return typeof d!="undefined"&&/safari/i.test(d.userAgent.replace(/chrome.*/i,""))}(),server:function(){return typeof d=="undefined"}(),tablet:function(){abaaso.client.tablet=this.tablet=typeof d!="undefined"&&/android|ipad|playbook|webos/i.test(d.userAgent)&&(abaaso.client.size.x>=1e3||abaaso.client.size.y>=1e3)},webos:function(){return typeof d!="undefined"&&/webos/i.test(d.userAgent)}(),windows:function(){return typeof d!="undefined"&&/windows/i.test(d.userAgent)}(),version:function(){var a=0;switch(!0){case this.chrome:a=d.userAgent.replace(/(.*chrome\/|safari.*)/gi,"");break;case this.firefox:a=d.userAgent.replace(/(.*firefox\/)/gi,"");break;case this.ie:a=d.userAgent.replace(/(.*msie|;.*)/gi,"");break;case this.opera:a=d.userAgent.replace(/(.*opera\/|\(.*)/gi,"");break;case this.safari:a=d.userAgent.replace(/(.*version\/|safari.*)/gi,"");break;default:a=typeof d!="undefined"?d.appVersion:0}return a=isNaN(parseInt(a))?0:parseInt(a),this.version=a,a},allows:function(a,b){try{if(a.isEmpty()||b.isEmpty())throw Error(m.error.invalidArguments);if(!g.get(a,!1))return undefined;b=b.toLowerCase();var c;switch(!0){case b==="delete":c=(a.permissions(b).bit&1)!==0;break;case b==="get":c=(a.permissions(b).bit&4)!==0;break;case/post|put/.test(b):c=(a.permissions(b).bit&2)!==0;break;default:c=!1}return c}catch(d){return v(d,arguments,this),undefined}},bit:function(a){var b=0;return a.each(function(a){switch(a.toLowerCase()){case"get":b|=4;break;case"post":case"put":b|=2;break;case"delete":b|=1}}),b},cors:function(a){return a.indexOf("//")>-1&&a.indexOf("//"+c.host)===-1},headers:function(a,b,c){var d=String(a.getAllResponseHeaders()).split("\n"),f={},i={},j=null,k=new Date,l,m;d.each(function(a){a.isEmpty()||(l=a.toString(),m=l.substr(l.indexOf(":")+1,l.length).replace(/\s/,""),l=l.substr(0,l.indexOf(":")).replace(/\s/,""),f[l]=m,/allow|access-control-allow-methods/i.test(l)&&(j=m))});switch(!0){case typeof f["Cache-Control"]!="undefined"&&/no/.test(f["Cache-Control"]):case typeof f.Pragma!="undefined"&&/no/.test(f.Pragma):break;case typeof f["Cache-Control"]!="undefined"&&/\d/.test(f["Cache-Control"]):k=k.setSeconds(k.getSeconds()+parseInt(/\d{1,}/.exec(f["Cache-Control"])[0]));break;case typeof f.Expires!="undefined":k=new Date(f.Expires);break;default:k=k.setSeconds(k.getSeconds()+e.expires)}return i.expires=k,i.headers=f,i.permission=h.bit(j!==null?j.explode():[c]),c!=="head"&&(g.set(b,"expires",i.expires),g.set(b,"headers",i.headers),g.set(b,"permission",i.permission)),i},permissions:function(a){var b=g.get(a,!1),c=b?b.permission:0,d={allows:[],bit:c,map:{read:4,write:2,"delete":1}};return c&1&&d.allows.push("DELETE"),c&2&&function(){d.allows.push("PUT"),d.allows.push("PUT")}(),c&4&&d.allows.push("GET"),d},jsonp:function(a,b,c,d){var f=(new String(a)).toString(),g=s.guid(!0),i,j,l;switch(!0){case typeof d=="undefined":case d===null:case d instanceof Object&&(d.callback===null||typeof d.callback=="undefined"):case typeof d=="string"&&d.isEmpty():i="callback";break;case d instanceof Object&&typeof d.callback!="undefined":i=d.callback;break;default:i="callback"}f=f.replace(i+"=?",""),f.on("failedGet",function(){this.un("failedGet",g).on("afterJSONP",function(a){this.un("afterJSONP",g).un("failedJSONP",g),typeof b=="function"&&b(a)},g).on("failedJSONP",function(){this.un("afterJSONP",g).un("failedJSONP",g),typeof c=="function"&&c()},g);do j=s.genId().slice(0,10);while(typeof abaaso.callback[j]!="undefined");a=a.replace(i+"=?",i+"=abaaso.callback."+j),abaaso.callback[j]=function(a){e.destroy(l),clearTimeout(abaaso.timer[j]),delete abaaso.timer[j],delete abaaso.callback[j],f.fire("afterJSONP",a)},l=k.create("script",{src:a,type:"text/javascript"},e("head")[0]),abaaso.timer[j]=setTimeout(function(){f.fire("failedJSONP")},3e4)},g);if(!h.safari||!h.cors(a))switch(!0){case d instanceof Object&&typeof d.Accept=="undefined":d.Accept="application/json";case d instanceof Object&&typeof d.Accept!="undefined":break;default:d={Accept:"application/json"}}return f.get(b,c,d)},request:function(a,b,d,e,f){try{if(/post|put/i.test(b)&&typeof f=="undefined")throw Error(m.error.invalidArguments);b=b.toLowerCase();var i=c,j=h.cors(a),k=h.ie&&h.version<10&&j?new XDomainRequest:new XMLHttpRequest,n=/post|put/i.test(b)&&typeof f!="undefined"?s.clone(f):null,o=b==="get"&&f instanceof Object?s.clone(f):null,p=b==="head"?!1:g.get(a),q=b.capitalize(),r=s.guid(!0),t=null,w=function(b){a.fire("failed"+q,b)},x=function(b){a.fire("timeout"+q,b)};b==="delete"&&a.on("afterDelete",function(){a.un("afterDelete",r),g.expire(a)},r),a.on("after"+q,function(b){a.un("after"+q,r).un("failed"+q,r),typeof d=="function"&&d(b)},r).on("failed"+q,function(b){a.un("after"+q,r).un("failed"+q,r),typeof e=="function"&&e(b)},r).fire("before"+q);if(b!=="head"&&a.allows(b)===!1)return a.fire("failed"+q);if(b==="get"&&Boolean(p))a.fire("afterGet",s.clone(p.response));else{k[k instanceof XMLHttpRequest?"onreadystatechange":"onload"]=function(){h.response(k,a,b)},typeof k.onerror=="object"&&(k.onerror=w),typeof k.ontimeout=="object"&&(k.ontimeout=x),typeof k.onprogress=="object"&&(k.onprogress=function(b){a.fire("progress"+q,b)}),k.open(b.toUpperCase(),a,!0);if(!j||!h.safari)typeof f!="undefined"&&f!==null&&f.hasOwnProperty("Content-Type")&&(t=f["Content-Type"]),j&&t===null&&(t="text/plain");n!==null&&(n.hasOwnProperty("Content-Type")&&delete n["Content-Type"],n.hasOwnProperty("withCredentials")&&delete n.withCredentials,n.hasOwnProperty("xml")&&(n=n.xml),n instanceof Document&&(n=u.decode(n)),typeof n=="string"&&/<[^>]+>[^<]*]+>/.test(n)&&(t="application/xml"),n instanceof Object&&(t="application/json",n=l.encode(n)),t===null&&(t="application/x-www-form-urlencoded; charset=UTF-8")),(!j||!h.safari)&&typeof k.setRequestHeader=="function"&&(o instanceof Object&&(o.hasOwnProperty("callback")&&delete o.callback,o.hasOwnProperty("withCredentials")&&delete o.withCredentials,o.hasOwnProperty("Content-Type")&&delete o["Content-Type"],s.iterate(o,function(a,b){a!==null&&k.setRequestHeader(b,a)})),typeof p=="object"&&p.headers.hasOwnProperty("ETag")&&k.setRequestHeader("ETag",p.headers.ETag),t!==null&&k.setRequestHeader("Content-Type",t)),typeof k.withCredentials=="boolean"&&f instanceof Object&&typeof f.withCredentials=="boolean"&&(k.withCredentials=f.withCredentials),a.fire("beforeXHR",{xhr:k,uri:a}),n!==null?k.send(n):k.send()}}catch(y){v(y,arguments,this),a.fire("failed"+q)}return a},response:function(a,b,d){try{var e=d.toLowerCase().capitalize(),f=c;switch(!0){case a.readyState===2:b.fire("received"+e);break;case a.readyState===4:b.fire("afterXHR",{xhr:a,uri:b});switch(a.status){case 200:case 204:case 205:case 301:var i=null,j=abaaso.state,k=h.headers(a,b,d),n=h.cors(b),o,p,q;switch(!0){case d==="head":return b.fire("afterHead",k.headers);case d!=="delete"&&/200|301/.test(a.status):p=typeof k.headers["Content-Type"]!="undefined"?k.headers["Content-Type"]:"";switch(!0){case(/json|plain|javascript/.test(p)||p.isEmpty())&&Boolean(q=l.decode(/[\{\[].*[\}\]]/.exec(a.responseText))):o=q;break;case/xml/.test(p)&&String(a.responseText).isEmpty()&&a.responseXML!==null:o=u.decode(typeof a.responseXML.xml!="undefined"?a.responseXML.xml:a.responseXML);break;case/<[^>]+>[^<]*]+>/.test(a.responseText):o=u.decode(a.responseText);break;default:o=a.responseText}if(typeof o=="undefined")throw Error(m.error.serverError);g.set(b,"response",k.response=o)}j.header!==null&&Boolean(i=k.headers[j.header])&&j.current!==i&&(typeof j.change=="function"?j.change(i):j.current=i);switch(a.status){case 200:b.fire("after"+e,s.clone(k.response));break;case 205:b.fire("reset");break;case 301:b.fire("moved",k.response)}break;case 401:throw Error(m.error.serverUnauthorized);case 403:throw g.set(b,"!permission",h.bit([d])),Error(m.error.serverForbidden);case 405:throw g.set(b,"!permission",h.bit([d])),Error(m.error.serverInvalidMethod);case 0:b.fire("failed"+e);break;default:throw Error(m.error.serverError)}break;case h.ie&&h.cors(b):var o,q;switch(!0){case Boolean(q=l.decode(/[\{\[].*[\}\]]/.exec(a.responseText))):o=q;break;case/<[^>]+>[^<]*]+>/.test(a.responseText):o=u.decode(a.responseText);break;default:o=a.responseText}g.set(b,"permission",h.bit(["get"])),g.set(b,"response",o),b.fire("afterGet",o)}}catch(r){v(r,arguments,this,!0),b.fire("failed"+e)}return b},size:function(){var a=0,c=0;return h.server||(a=typeof b.documentElement!="undefined"?b.documentElement.clientWidth:b.body.clientWidth,c=typeof b.documentElement!="undefined"?b.documentElement.clientHeight:b.body.clientHeight),{x:a,y:c}}},i={expire:function(a){return typeof i.get(a)!="undefined"&&i.set(a,"","-1s"),a},get:function(a){return i.list()[a]},list:function(){var a={},c,d;return!h.server&&typeof b.cookie!="undefined"&&!b.cookie.isEmpty()&&(d=b.cookie.split(";"),d.each(function(b){c=b.split("="),a[decodeURIComponent(c[0].toString().trim())]=decodeURIComponent(c[1].toString().trim())})),a},set:function(a,c,d){typeof d=="undefined"&&(d="");var e="",f=null,g=null,h=["d","h","m","s"],j=h.length;if(!d.isEmpty()){while(j--)if((new RegExp(h[j])).test(d)){g=h[j],f=parseInt(d);break}if(isNaN(f))throw Error(m.error.invalidArguments);e=new Date;switch(g){case"d":e.setDate(e.getDate()+f);break;case"h":e.setHours(e.getHours()+f);break;case"m":e.setMinutes(e.getMinutes()+f);break;case"s":e.setSeconds(e.getSeconds()+f)}}return e instanceof Date&&(e="; expires="+e.toUTCString()),b.cookie=a.toString().trim()+"="+c+e+"; path=/",i.get(a)}},j={methods:{batch:function(a,b,c){try{a=a.toString().toLowerCase()||undefined,c=c===!0;if(!/^(set|del)$/.test(a)||typeof b!="object")throw Error(m.error.invalidArguments);var d=this.parentNode,e=this,f;return d.fire("beforeDataBatch"),c&&this.clear(!0),b instanceof Array?b.each(function(b,d){a==="set"?(e.key!==null&&typeof b[e.key]!="undefined"?(f=b[e.key],delete b[e.key]):f=d.toString(),e.set(f,b,c)):e.del(b,!1,c)}):s.iterate(b,function(b,d){a==="set"?(e.key!==null&&typeof b[e.key]!="undefined"?(f=b[e.key],delete b[e.key]):f=d.toString(),e.set(f,b,c)):e.del(b,!1,c)}),a==="del"&&this.reindex(),d.fire("afterDataBatch"),this}catch(g){return v(g,arguments,this),undefined}},clear:function(a){a=a===!0;var b=this.parentNode;return a?(this.keys={},this.records=[],this.total=0,this.views={}):(b.fire("beforeDataClear"),this.callback=null,this.credentials=null,this.expires=null,this._expires=null,this.key=null,this.keys={},this.records=[],this.source=null,this.total=0,this.views={},this.uri=null,this._uri=null,b.fire("afterDataClear")),this},del:function(a,b,c){if(typeof a=="undefined"||typeof a!="number"&&typeof a!="string")throw Error(m.error.invalidArguments);b=b!==!1,c=c===!0;var d=this.parentNode,e={},f=/true|undefined/,g,h,i;switch(typeof a){case"string":g=a,a=this.keys[g];if(typeof g=="undefined")throw Error(m.error.invalidArguments);a=a.index;break;default:g=this.records[a];if(typeof g=="undefined")throw Error(m.error.invalidArguments);g=g.key}h={key:g,record:a,reindex:b},this.uri!==null&&(i=this.uri+"/"+g,e.uri=i.allows("delete"),e.data=this.uri.allows("delete")),d.fire("beforeDataDelete",h);switch(!0){case c:case this.uri===null:d.fire("syncDataDelete",h);break;case f.test(e.data)&&f.test(e.uri):i.del(function(){d.fire("syncDataDelete",h)},function(){d.fire("failedDataDelete",h)});break;default:d.fire("failedDataDelete",h)}return this},find:function(a,b){try{if(typeof a=="undefined")throw Error(m.error.invalidArguments);var c=[],d=typeof a=="string"?a.explode():a,e=[],f,g=d.length,h=this.parentNode,i={},j,k,l,n,o,p,q,r;h.fire("beforeDataFind"),n=this.records.first();switch(!0){case typeof b=="string":c=b.explode(),q=c.length;while(q--)if(!n.data.hasOwnProperty(c[q]))throw Error(m.error.invalidArguments);break;default:s.iterate(n.data,function(a,b){c.push(b)})}f=c.length,r=this.total;for(q=0;q<r;q++)for(j=0;j<f;j++)for(k=0;k<g;k++)l=c[j],p=d[k],n=new RegExp(p,"gi"),o=this.records[q].data[l],!i[this.records[q].key]&&n.test(o)&&(i[this.records[q].key]=q,e.push(this.records[q]));return h.fire("afterDataFind",i),e}catch(t){return v(t,arguments,this),undefined}},form:function(a,b,c){try{var d=a===null,f=this,g,h,i,j,l,n;switch(!0){case d:a=this.get(0);break;case!(a instanceof Object):a=this.get(a)}switch(!0){case typeof a=="undefined":throw Error(m.error.invalidArguments);case this.uri!==null&&!this.uri.allows("post"):throw Error(m.error.serverInvalidMethod)}return l=a.key,n=a.data,typeof b!="undefined"&&(b=s.object(b)),g=this.uri.replace(/.*\//,"").replace(/\?.*/,""),g.isDomain()&&(g=g.replace(/\..*/g,"")),i=function(a){var b=a.srcElement.parentNode,d=e("#"+b.id+" input"),g=d[0].name.match(/(.*)\[/)[1],h=!0,i={};f.parentNode.fire("beforeDataFormSubmit"),c&&(h=b.validate());switch(h){case!1:f.parentNode.fire("failedDataFormSubmit");break;case!0:d.each(function(a){s.define(a.name.replace("[",".").replace("]",""),a.value,i)}),f.set(l,i[g])}f.parentNode.fire("afterDataFormSubmit",l)},j=function(a,b,c){var e,f;s.iterate(a,function(a,g){switch(!0){case a instanceof Array:e=0,a.each(function(a){j(a,b,c+"["+g+"]["+e++ +"]")});break;case a instanceof Object:j(a,b,c+"["+g+"]");break;default:f=(c+"["+g+"]").replace(/\[|\]/g,""),b.create("label",{"for":f}).html(g.capitalize()),b.create("input",{id:f,name:c+"["+g+"]",type:"text",value:d?"":a})}})},this.parentNode.fire("beforeDataForm"),h=k.create("form",{style:"display:none;"},b),j(n,h,g),h.create("input",{type:"button",value:m.common.submit}).on("click",function(a){i(a)}),h.create("input",{type:"reset",value:m.common.reset}),h.css("display","inherit"),this.parentNode.fire("afterDataForm",h),h}catch(o){return v(o,arguments,this),undefined}},get:function(a){var b=[],c=this.parentNode,d,e,f;c.fire("beforeDataGet");switch(!0){case typeof a=="undefined"||String(a).length===0:b=[],this.records.each(function(a){b.push(s.clone(a))});break;case typeof a=="string"&&typeof this.keys[a]!="undefined":b=s.clone(this.records[this.keys[a].index]);break;case typeof a=="number":b=s.clone(this.records[a]);break;case a instanceof Array:if(!!isNaN(a[0])||!!isNaN(a[1]))throw Error(m.error.invalidArguments);e=a[0],f=a[1];for(d=e;d<f;d++)typeof this.records[d]!="undefined"&&b.push(s.clone(this.records[d]));break;default:b=undefined}return c.fire("afterDataGet",b),b},reindex:function(){var a=this.total,b=this.parentNode,c;b.fire("beforeDataReindex"),this.views={};for(c=0;c<a;c++)this.records[c].key.isNumber()&&(delete this.keys[this.records[c].key],this.keys[c.toString()]={},this.records[c].key=c.toString()),this.keys[this.records[c].key].index=c;return b.fire("afterDataReindex"),this},set:function(a,b,c){a=a===null?undefined:a.toString(),c=c===!0;switch(!0){case(typeof a=="undefined"||a.isEmpty())&&this.uri===null:case typeof b=="undefined":case b instanceof Array:case b instanceof Number:case b instanceof String:case typeof b!="object":throw Error(m.error.invalidArguments)}var d=typeof this.keys[a]=="undefined"&&typeof this.records[a]=="undefined"?undefined:this.get(a),e=this.parentNode,f=typeof a=="undefined"?"post":"put",g={data:b,key:a,record:undefined},h=this.uri===null?null:this.uri+"/"+a,i={},j=/true|undefined/;typeof d!="undefined"&&(g.record=this.records[this.keys[d.key].index]),h!==null&&(i.uri=h.allows(f),i.data=this.uri.allows(f)),e.fire("beforeDataSet");switch(!0){case c:case this.uri===null:e.fire("syncDataSet",g);break;case j.test(i.data)&&j.test(i.uri):h[f](function(a){g.result=a,e.fire("syncDataSet",g)},function(){e.fire("failedDataSet")},b);break;default:e.fire("failedDataSet",g)}return this},sort:function(a,b){try{if(typeof a=="undefined"||String(a).isEmpty())throw Error(m.error.invalidArguments);b=b===!0;var c=this.parentNode,d=a.replace(/\s*asc/g,"").replace(/,/g," ").toCamelCase(),e=a.explode(),f=!0,g=/:::(.*)$/,h=/\s*asc$/i,i=/\s*desc$/i,j=this,k=[],l=[],n=/^null/,o,p,q,r,s,t,u,w,x;if(e.last().isEmpty())throw Error(m.error.invalidArguments);return!b&&this.views[d]instanceof Array?this.views[d]:this.total===0?this.records:(c.fire("beforeDataSort"),e.each(function(a){a=a.replace(h,""),x=a.replace(i,""),o=[];switch(f){case!0:p=j.records.clone(),f=!1;if(!p[0].data.hasOwnProperty(x))throw Error(m.error.invalidArguments);p.each(function(a){q=String(a.data[x])+":::"+a.key,o.push(q.replace(n,'""'))}),o.sort(),i.test(a)&&o.reverse(),o.each(function(a){r=j.keys[g.exec(a)[1]].index,k.push(j.records[r])});break;default:p=k.clone(),k=[],o=[],s={},w=null;if(!p[0].data.hasOwnProperty(x))throw Error(m.error.invalidArguments);p.each(function(a,b){w!==a.data[u]&&(w=a.data[u]),t=w===null?"null":w.charAt(0).toLowerCase(),s[t]instanceof Array||(s[t]=[],o.push(t)),q=String(a.data[x]).trim()+":::"+b,s[t].push(q.replace(n,'""'))}),o.each(function(b){s[b].sort(),i.test(a)&&s[b].reverse(),s[b].each(function(a){k.push(p[g.exec(a)[1]])})})}u=a}),this.views[d]=k,c.fire("afterDataSort",k),k)}catch(y){return v(y,arguments,this),undefined}},sync:function(a){try{if(this.uri===null||this.uri.isEmpty())throw Error(m.error.invalidArguments);a=a===!0;var b=this,c=b.parentNode,d=s.guid(!0),e,f;return e=function(d){try{if(typeof d!="object")throw Error(m.error.expectedObject);var e,f=!1;b.source!==null&&typeof d[b.source]!="undefined"&&(d=d[b.source]),d instanceof Array?e=d.clone():s.iterate(d,function(a){!f&&a instanceof Array&&(f=!0,e=a.clone())}),b.batch("set",e,!0),a&&b.reindex(),c.fire("afterDataSync",d)}catch(g){v(g,arguments,this),c.fire("failedDataSync")}},f=function(){c.fire("failedDataSync")},c.fire("beforeDataSync"),this.uri.jsonp(e,f,{callback:this.callback,withCredentials:this.credentials}),this}catch(g){return v(g,arguments,this),this}}},register:function(a,b){if(a instanceof Array)return a.each(function(a){b.register(a,b)});var c={expires:{getter:function(){return this._expires},setter:function(a){try{if(this.uri===null||a!==null&&(isNaN(a)||typeof a=="boolean"))throw Error(m.error.invalidArguments);if(this._expires===a)return;this._expires=a;var b=this.parentNode.id+"DataExpire",c=a,d=this;clearTimeout(e.repeating[b]),delete e.repeating[b],a!==null&&e.defer(function(){e.repeat(function(){g.expire(d.uri)||d.uri.fire("beforeExpire").fire("expire").fire("afterExpire")},c,b)},c)}catch(f){return v(f,arguments,this),undefined}}},uri:{getter:function(){return this._uri},setter:function(a){try{if(a!==null&&a.isEmpty())throw Error(m.error.invalidArguments);switch(!0){case this._uri===a:return;case this._uri!==null:this._uri.un("expire","dataSync"),g.expire(this._uri,!0);default:this._uri=a}switch(!0){case a!==null:a.on("expire",function(){this.sync(!0)},"dataSync",this),g.expire(a,!0),this.sync();break;default:this.clear(!0)}}catch(b){return v(b,arguments,this),undefined}}}};a=s.object(a),e.genId(a),typeof a.fire=="undefined"&&(a.fire=function(a,b){return e.fire.call(this,a,b)}),typeof a.listeners=="undefined"&&(a.listeners=function(a){return e.listeners.call(this,a)}),typeof a.on=="undefined"&&(a.on=function(a,b,c,d,f){return e.on.call(this,a,b,c,d,f)}),typeof a.un=="undefined"&&(a.un=function(a,b){return e.un.call(this,a,b)}),a.fire("beforeDataStore"),a.data=e.extend(this.methods),a.data.parentNode=a,a.data.clear(),a.on("syncDataDelete",function(a){var b=this.get(a.record);return this.records.remove(a.record),delete this.keys[a.key],this.total--,this.views={},a.reindex&&this.reindex(),this.parentNode.fire("afterDataDelete",b),this.parentNode},"recordDelete",a.data),a.on("syncDataSet",function(a){var b;switch(!0){case typeof a.record=="undefined":var c=this.total;this.total++;if(typeof a.key=="undefined"){if(typeof a.result=="undefined")throw this.fire("failedDataSet"),Error(m.error.expectedObject);a.key=this.key===null?f.cast(a.result).first():a.result[this.key],a.key=a.key.toString()}typeof a.data[a.key]!="undefined"&&(a.key=a.data[a.key]),this.keys[a.key]={},this.keys[a.key].index=c,this.records[c]={},b=this.records[c],b.data=s.clone(a.data),b.key=a.key,this.key!==null&&this.records[c].data.hasOwnProperty(this.key)&&delete this.records[c].data[this.key];break;default:a.record.data=s.clone(a.data),b=a.record}this.views={},this.parentNode.fire("afterDataSet",b)},"recordSet",a.data);switch(!0){case(!h.ie||h.version>8)&&typeof Object.defineProperty=="function":Object.defineProperty(a.data,"uri",{get:c.uri.getter,set:c.uri.setter}),Object.defineProperty(a.data,"expires",{get:c.expires.getter,set:c.expires.setter});break;case typeof a.data.__defineGetter__=="function":a.data.__defineGetter__("expires",c.expires.getter),a.data.__defineSetter__("expires",c.expires.setter),a.data.__defineGetter__("uri",c.uri.getter),a.data.__defineSetter__("uri",c.uri.setter);break;default:a.data.setExpires=function(b){a.data.expires=b,c.expires.setter.call(a.data,b)},a.data.setUri=function(b){a.data.uri=b,c.uri.setter.call(a.data,b)}}return typeof b=="object"&&a.data.batch("set",b),a.fire("afterDataStore"),a}},k={attr:function(a,b,c){try{a=s.object(a);if(a instanceof Array)return a.attr(b,c);if(!(a instanceof Element&&typeof b!="undefined"&&!String(b).isEmpty()))throw Error(m.error.invalidArguments);switch(typeof c=="undefined"){case!0:return a.getAttribute(b);case!1:return a.setAttribute(b,c),a}}catch(d){return v(d,arguments,this),undefined}},clear:function(a){try{a=s.object(a);if(a instanceof Array)return a.each(function(a){k.clear(a)});if(a instanceof Element){a.fire("beforeClear");switch(!0){case typeof a.reset=="function":a.reset();break;case typeof a.value!="undefined":a.update({innerHTML:"",value:""});break;default:a.update({innerHTML:""})}return a.fire("afterClear"),a}throw Error(m.error.invalidArguments)}catch(b){return v(b,arguments,this),undefined}},create:function(a,c,d,f){try{if(typeof a=="undefined"||String(a).isEmpty())throw Error(m.error.invalidArguments);var g,h;switch(!0){case typeof d!="undefined":d=s.object(d);break;case typeof c!="undefined"&&(typeof c=="string"||typeof c.childNodes!="undefined"):d=s.object(c);break;default:d=b.body}if(typeof d=="undefined")throw Error(m.error.invalidArguments);h=typeof c!="undefined"&&typeof c!="string"&&typeof c.childNodes=="undefined"&&typeof c.id!="undefined"&&typeof e("#"+c.id)=="undefined"?c.id:s.genId(),typeof c!="undefined"&&typeof c.id!="undefined"&&delete c.id,e.fire("beforeCreate",h),h.fire("beforeCreate"),g=b.createElement(a),g.id=h,typeof c=="object"&&typeof c.childNodes=="undefined"&&g.update(c);switch(!0){case typeof f=="undefined":case f==="last":d.appendChild(g);break;case f==="first":d.prependChild(g);break;case f==="after":f={},f.after=d,d=d.parentNode;case typeof f.after!="undefined":d.insertBefore(g,f.after.nextSibling);break;case f==="before":f={},f.before=d,d=d.parentNode;case typeof f.before!="undefined":d.insertBefore(g,f.before);break;default:d.appendChild(g)}return g.fire("afterCreate"),e.fire("afterCreate",g),g}catch(i){return v(i,arguments,this),undefined}},css:function(a){var c,d;return c=e.create("style",{type:"text/css"},e("head")[0]),c.styleSheet?c.styleSheet.cssText=a:(d=b.createTextNode(a),c.appendChild(d)),c},destroy:function(a){try{a=s.object(a);if(a instanceof Array)return a.each(function(a){k.destroy(a)}),[];if(!(a instanceof Element))throw Error(m.error.invalidArguments);e.fire("beforeDestroy",a),a.fire("beforeDestroy"),r.remove(a.id),a.parentNode!==null&&a.parentNode.removeChild(a),a.fire("afterDestroy"),e.fire("afterDestroy",a.id)}catch(b){v(b,arguments,this)}return undefined},disable:function(a){try{a=s.object(a);if(a instanceof Array)return a.each(function(a){k.disable(a)});if(a instanceof Element)return typeof a.disabled=="boolean"&&!a.disabled&&(a.fire("beforeDisable"),a.disabled=!0,a.fire("afterDisable")),a;throw Error(m.error.invalidArguments)}catch(b){return v(b,arguments,this),undefined}},enable:function(a){try{a=s.object(a);if(a instanceof Array)return a.each(function(a){k.enable(a)});if(a instanceof Element)return typeof a.disabled=="boolean"&&a.disabled&&(a.fire("beforeEnable"),a.disabled=!1,a.fire("afterEnable")),a;throw Error(m.error.invalidArguments)}catch(b){return v(b,arguments,this),undefined}},hasClass:function(a,b){try{a=s.object(a);if(a instanceof Array)return a.each(function(a){k.hide(a)});if(a instanceof Element)return a.className.explode(" ").index(b)>-1;throw Error(m.error.invalidArguments)}catch(c){return v(c,arguments,this),undefined}},hide:function(a){try{a=s.object(a);if(a instanceof Array)return a.each(function(a){k.hide(a)});if(a instanceof Element){a.fire("beforeHide");switch(!0){case typeof a.hidden=="boolean":a.hidden=!0;break;default:a["data-display"]=a.style.display,a.style.display="none"}return a.fire("afterHide"),a}throw Error(m.error.invalidArguments)}catch(b){return v(b,arguments,this),undefined}},hidden:function(a){try{a=s.object(a);if(a instanceof Element)return a.style.display==="none"||typeof a.hidden=="boolean"&&a.hidden;throw Error(m.error.invalidArguments)}catch(b){return v(b,arguments,this),undefined}},klass:function(a,b,c){try{a=s.object(a);if(a instanceof Array)return a.each(function(a){k.klass(a,b,c)});if(a instanceof Element&&!String(b).isEmpty()){c=c!==!1,a.fire("beforeClassChange");var d=a.className.split(" "),e=d.length,f;switch(!0){case c:d.index(b)<0&&d.push(b);break;case!c:b==="*"?d=[]:d.remove(b)}return d=d.join(" "),h.ie&&h.version<9?a.className=d:a.attr("class",d),a.fire("afterClassChange"),a}throw Error(m.error.invalidArguments)}catch(g){return v(g,arguments,this),undefined}},position:function(c){try{c=s.object(c);if(c instanceof Array)return c.position();if(c instanceof Element){var d,e,f,g;d=e=0,g=c.offsetWidth,f=c.offsetHeight;if(c.offsetParent){e=c.offsetTop,d=c.offsetLeft;while(c=c.offsetParent)d+=c.offsetLeft,e+=c.offsetTop}return{top:e,right:b.documentElement.clientWidth-(d+g),bottom:b.documentElement.clientHeight+a.scrollY-(e+f),left:d}}throw Error(m.error.invalidArguments)}catch(h){return v(h,arguments,this),undefined}},prependChild:function(a,b){try{a=s.object(a);if(a instanceof Element&&b instanceof Element)return a.childNodes.length===0?a.appendChild(b):a.insertBefore(b,a.childNodes[0]);throw Error(m.error.invalidArguments)}catch(c){return v(c,arguments,this),undefined}},show:function(a){try{a=s.object(a);if(a instanceof Array)return a.each(function(a){k.show(a)});if(a instanceof Element){a.fire("beforeShow");switch(!0){case typeof a.hidden=="boolean":a.hidden=!1;break;default:a.style.display=a.getAttribute("data-display")!==null?a.getAttribute("data-display"):"inherit"}return a.fire("afterShow"),a}throw Error(m.error.invalidArguments)}catch(b){return v(b,arguments,this),undefined}},size:function(a){try{a=s.object(a);if(a instanceof Array){var b=[];return a.each(function(a){b.push(k.size(a))}),b}if(a instanceof Element){var c=function(a){return isNaN(parseInt(a))?0:parseInt(a)},d=a.offsetHeight+c(a.style.paddingTop)+c(a.style.paddingBottom)+c(a.style.borderTop)+c(a.style.borderBottom),e=a.offsetWidth+c(a.style.paddingLeft)+c(a.style.paddingRight)+c(a.style.borderLeft)+c(a.style.borderRight);return{x:d,y:e}}throw Error(m.error.invalidArguments)}catch(f){return v(f,arguments,this),undefined}},update:function(a,b){try{a=s.object(a),b=b||{};if(a instanceof Array)return a.each(function(a){k.update(a,b)});if(a instanceof Element)return a.fire("beforeUpdate"),s.iterate(b,function(b,c){switch(c){case"innerHTML":case"type":case"src":a[c]=b;break;case"class":b.isEmpty()?a.removeClass("*"):a.addClass(b);break;case"id":var d=r.listeners;typeof d[a.id]!="undefined"&&(d[c]=s.clone(d[a.id]),delete d[a.id]);default:a.attr(c,b)}}),a.fire("afterUpdate"),a;throw Error(m.error.invalidArguments)}catch(c){return v(c,arguments,this),undefined}},val:function(a,b){try{var c=null,d;a=s.object(a);if(a instanceof Array)return a.each(function(a){k.val(a,b)});if(a instanceof Element){switch(!0){case typeof b=="undefined":switch(!0){case/radio|checkbox/gi.test(a.type):d=e("input[name='"+a.name+"']"),d.each(function(a){if(c!==null)return;a.checked&&(c=a.value)});break;case/select/gi.test(a.type):c=a.options[a.selectedIndex].value;break;default:c=typeof a.value!="undefined"?a.value:a.innerText}break;default:switch(!0){case/radio|checkbox/gi.test(a.type):d=e("input[name='"+a.name+"']"),d.each(function(a){if(c!==null)return;a.value===b&&(a.checked=!0,c=a)});break;case/select/gi.test(a.type):f.cast(a.options).each(function(a){if(c!==null)return;a.value===b&&(a.selected=!0,c=a)});break;default:typeof a.value!="undefined"?a.value=b:a.innerText=b}c=a}return c}throw Error(m.error.invalidArguments)}catch(g){return v(g,arguments,this),undefined}}},l={decode:function(a,b){try{return JSON.parse(a)}catch(c){return b!==!0&&v(c,arguments,this),undefined}},encode:function(a,b){try{return JSON.stringify(a)}catch(c){return b!==!0&&v(c,arguments,this),undefined}}},m={common:{back:"Back",cancel:"Cancel",clear:"Clear",close:"Close",cont:"Continue",del:"Delete",edit:"Edit",find:"Find",gen:"Generate",go:"Go",loading:"Loading",next:"Next",login:"Login",ran:"Random",reset:"Reset",save:"Save",search:"Search",submit:"Submit"},day:{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},error:{databaseNotOpen:"Failed to open the Database, possibly exceeded Domain quota",databaseNotSupported:"Client does not support local database storage",databaseWarnInjection:"Possible SQL injection in database transaction, use the &#63; placeholder",elementNotCreated:"Could not create the Element",elementNotFound:"Could not find the Element",expectedArray:"Expected an Array",expectedArrayObject:"Expected an Array or Object",expectedBoolean:"Expected a Boolean value",expectedNumber:"Expected a Number",expectedObject:"Expected an Object",invalidArguments:"One or more arguments is invalid",invalidDate:"Invalid Date",invalidFields:"The following required fields are invalid: ",propertyNotFound:"Could not find the requested property",serverError:"Server error has occurred",serverForbidden:"Forbidden to access URI",serverInvalidMethod:"Method not allowed",serverUnauthorized:"Authorization required to access URI"},month:{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"}},o={clear:function(){return e.un(a,"message")},send:function(a,b){try{return a.postMessage(b,"*"),a}catch(c){return v(c,arguments,this),undefined}},recv:function(b){return e.on(a,"message",b)}},p={enabled:!1,log:!1,diff:{x:null,y:null},pos:{x:null,y:null},prev:{x:null,y:null},track:function(a){var c=abaaso.mouse;switch(!0){case typeof a=="object":var d=a.pageX?a.pageX:(h.ie&&h.version<9?b.documentElement.scrollLeft:b.body.scrollLeft)+n.clientX,f=a.pageY?a.pageY:(h.ie&&h.version<9?b.documentElement.scrollTop:b.body.scrollTop)+n.clientY,g=!1;c.pos.x!==d&&(g=!0),e.mouse.prev.x=c.prev.x=Number(c.pos.x),e.mouse.pos.x=c.pos.x=d,e.mouse.diff.x=c.diff.x=c.pos.x-c.prev.x,c.pos.y!==f&&(g=!0),e.mouse.prev.y=c.prev.y=Number(c.pos.y),e.mouse.pos.y=c.pos.y=f,e.mouse.diff.y=c.diff.y=c.pos.y-c.prev.y,g&&c.log&&s.log(c.pos.x+" ["+c.diff.x+"], "+c.pos.y+" ["+c.diff.y+"]");break;case typeof a=="boolean":a?r.add(b,"mousemove",abaaso.mouse.track):r.remove(b,"mousemove"),e.mouse.enabled=c.enabled=a}return c}},q={diff:function(a){try{if(typeof a!="number"||typeof this!="number")throw Error(m.error.expectedNumber);return Math.abs(this-a)}catch(b){return v(b,arguments,this),undefined}},format:function(a,b,c){try{if(typeof a!="number")throw Error(m.error.expectedNumber);a=a.toString(),b=b||",",c=c||3;var d=a.indexOf(".")>-1?"."+a.replace(/.*\./,""):"",e=a.replace(/\..*/,"").split("").reverse(),f=Math.floor(e.length/c),g=1,h,i;for(i=0;i<f;i++)h=g===1?c:c*g+(g===2?1:g-1),e.splice(h,0,b),g++;return e=e.reverse().join(""),e.charAt(0)===b&&(e=e.substring(1)),e+d}catch(j){return v(j,arguments,this),undefined}},even:function(a){return a%2===0},odd:function(a){return a%2!==0}},r={listeners:{},log:!1,add:function(b,c,d,f,g,h){try{b=s.object(b),g=g||abaaso,h=h||"active";if(b instanceof Array)return b.each(function(a){r.add(a,c,d,f,g,h)});if(typeof f=="undefined"||!/\w/.test(f))f=s.guid(!0);var i=null,j=r.listeners,k=this.id(b),l,n;if(typeof k=="undefined"||typeof c=="undefined"||typeof d!="function")throw Error(m.error.invalidArguments);typeof j[k]=="undefined"&&(j[k]={}),typeof j[k][c]=="undefined"&&(j[k][c]={}),typeof j[k][c].active=="undefined"&&(j[k][c].active={}),typeof j[k][c][h]=="undefined"&&(j[k][c][h]={}),n={fn:d,scope:g},j[k][c][h][f]=n;if(h==="active"){switch(!0){case/body|document|window/i.test(k):i=b;break;default:i=!/\//g.test(k)&&k!=="abaaso"?e("#"+k):null}l=function(d){c.indexOf("key")!==0&&(d||(d=a.event),typeof d.cancelBubble!="undefined"&&(d.cancelBubble=!0),typeof d.preventDefault=="function"&&d.preventDefault(),typeof d.stopPropagation=="function"&&d.stopPropagation()),typeof i.fire=="function"?i.fire(c,d):r.fire(b,c,d)},i!==null&&c.toLowerCase()!=="afterjsonp"&&typeof i!="undefined"&&(typeof i.addEventListener=="function"?i.addEventListener(c,l,!1):i.attachEvent("on"+c,l))}return b}catch(o){return v(o,arguments,this),undefined}},id:function(c){var d;switch(!0){case c===abaaso:d="abaaso";break;case c===a:d="window";break;case c===b:d="document";break;case c===b.body:d="body";break;default:d=typeof c.id!="undefined"?c.id:typeof c.toString=="function"?c.toString():c}return d},fire:function(a,b,c){try{a=s.object(a);if(a instanceof Array)return a.each(function(d){r.fire(a[d],b,c)});var d=this.id(a),f=c,g,h;if(typeof d=="undefined"||String(d).isEmpty()||typeof a=="undefined"||typeof b=="undefined")throw Error(m.error.invalidArguments);return(e.observer.log||abaaso.observer.log)&&s.log("["+(new Date).toLocaleTimeString()+" - "+d+"] "+b),h=this.list(a,b).active,s.iterate(h,function(a,b){a.fn.call(a.scope,f)}),e.observer.fired++,a}catch(i){return v(i,arguments,this),undefined}},list:function(a,b){a=s.object(a);var c=this.listeners,d=this.id(a),e;switch(!0){case typeof c[d]=="undefined"&&typeof b=="undefined":e={};break;case typeof c[d]!="undefined"&&(typeof b=="undefined"||String(b).isEmpty()):e=c[d];break;case typeof c[d]!="undefined"&&typeof c[d][b]!="undefined":e=c[d][b];break;default:e={active:{}}}return e},remove:function(b,c,d,f){b=s.object(b),f=f||"active";if(b instanceof Array)return b.each(function(a){r.remove(a,c,d,f)});var g=null,h=r.listeners,i=this.id(b),j,k;switch(!0){case typeof i=="undefined":case typeof c=="undefined":case typeof h[i]=="undefined":case typeof h[i][c]=="undefined":return b}typeof d=="undefined"?h[i][c][f]={}:delete h[i][c][f][d];if(f==="active"){switch(!0){case/body|document|window/i.test(i):g=b;break;default:g=i.indexOf("/")===-1&&i!=="abaaso"?e("#"+i):null}k=function(d){c.indexOf("key")!==0&&(d||(d=a.event),typeof d.cancelBubble!="undefined"&&(d.cancelBubble=!0),typeof d.preventDefault=="function"&&d.preventDefault(),typeof d.stopPropagation=="function"&&d.stopPropagation()),typeof g.fire=="function"?g.fire(c):r.fire(b,c,d)},g!==null&&c.toLowerCase()!=="afterjsonp"&&typeof g!="undefined"&&(typeof g.removeEventListener=="function"?g.removeEventListener(c,k,!1):g.detachEvent("on"+c,k))}return b},state:function(a){var b=this.listeners,c=e.state.previous,d;return s.iterate(b,function(b,d){s.iterate(b,function(d,e){b[c]=b.active,b.active=b[a]||{},typeof b[a]!="undefined"&&delete b[a]})}),e.fire(a),abaaso}},s={$:function(a,c){var d=[],g,h;a=a.trim(),c=c===!0,a.indexOf(",")>-1&&(a=a.explode());if(a instanceof Array)return a.each(function(a){d.push(e(a,c))}),d;switch(!0){case/\s|>/.test(a):h=a.split(" ").filter(function(a){if(a.trim()!==""&&a!==">")return!0}).last(),g=b[h.indexOf("#")>-1&&h.indexOf(":")===-1?"querySelector":"querySelectorAll"](a);break;case a.indexOf("#")===0&&a.indexOf(":")===-1:g=isNaN(a.charAt(1))?b.querySelector(a):b.getElementById(a.substring(1));break;case a.indexOf("#")>-1&&a.indexOf(":")===-1:g=b.querySelector(a);break;default:g=b.querySelectorAll(a)}return g!==null&&!(g instanceof Element)&&!c&&(g=f.cast(g)),g===null&&(g=undefined),g},alias:function(a,b){var c=a,d=b;return s.iterate(d,function(a,b){var e,f;switch(!0){case!(a instanceof RegExp)&&typeof a=="function":c[b]=a.bind(c[b]);break;case!(a instanceof RegExp)&&!(a instanceof Array)&&a instanceof Object:typeof c[b]=="undefined"&&(c[b]={}),s.alias(c[b],d[b]);break;default:e=function(){return d[b]},f=function(a){d[b]=a};switch(!0){case(!h.ie||h.version>8)&&typeof Object.defineProperty=="function":Object.defineProperty(c,b,{get:e,set:f});break;case typeof c.__defineGetter__=="function":c.__defineGetter__(b,e),c.__defineSetter__(b,f);break;default:c[b]=d[b]}}}),a},clone:function(a){var b;switch(!0){case typeof a=="boolean":b=Boolean(a);break;case typeof a=="function":b=a;break;case typeof a=="number":b=Number(a);break;case typeof a=="string":b=String(a);break;case!h.ie&&a instanceof Document:b=u.decode(u.encode(a));break;case a instanceof Array:b=[].concat(a);break;case a instanceof Object:b=l.decode(l.encode(a)),typeof b=="undefined"&&(b=a);break;default:b=a}return typeof a!="undefined"&&(a.hasOwnProperty("constructor")&&(b.constructor=a.constructor),a.hasOwnProperty("prototype")&&(b.prototype=a.prototype)),b},define:function(a,b,c){a=a.split("."),c=c||this,b=b||null;if(typeof c=="undefined"||c===e)c=abaaso;var d=c,g=a.length;return a.each(function(c){var e=a.index(c),h=g,i=e+1<h&&!isNaN(parseInt(a[e+1])),j=b;isNaN(parseInt(c))||(c=parseInt(c));switch(!0){case typeof d[c]=="undefined":d[c]=i?[]:{};break;case d[c]instanceof Object&&i:d[c]=f.cast(d[c]);break;case d[c]instanceof Array&&!i:d[c]=d[c].toObject();break;default:d[c]={}}switch(!0){case e+1===h:d[c]=j;break;default:d=d[c]}}),c},defer:function(a,b,c){if(typeof c=="undefined"||String(c).isEmpty())c=s.guid(!0);var d=function(){delete abaaso.timer[c],a()};return abaaso.timer[c]=setTimeout(d,b),undefined},domId:function(a){return"a"+a.replace(/-/g,"").slice(1)},error:function(a,b,c,d){if(typeof a=="undefined")return;d=d===!0;var f={arguments:b,message:typeof a.message!="undefined"?a.message:a,number:typeof a.number!="undefined"?a.number&65535:undefined,scope:c,timestamp:(new Date).toUTCString(),type:typeof a.type!="undefined"?a.type:"TypeError"};return typeof console!="undefined"&&console[d?"warn":"error"](f.message),e.error.log.push(f),e.fire("error",f),undefined},extend:function(a,b){try{if(typeof a=="undefined")throw Error(m.error.invalidArguments);typeof b=="undefined"&&(b={});var c,d;switch(!0){case typeof Object.create=="function":c=Object.create(a);break;default:d=function(){},d.prototype=a,c=new d}return s.merge(c,b),c}catch(e){return v(e,arguments,this),undefined}},genId:function(a){switch(!0){case a instanceof Array:case a instanceof String:case typeof a=="string":case typeof a!="undefined"&&typeof a.id!="undefined"&&/\w/.test(a.id):return a}var b;do b=s.domId(s.guid(!0));while(typeof e("#"+b)!="undefined");return typeof a=="object"?(a.id=b,a):b},guid:function(a){a=a===!0;var b=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},c;return c=(b()+b()+"-"+b()+"-4"+b().substr(0,3)+"-"+b()+"-"+b()+b()+b()).toLowerCase(),a&&(c=c.replace(/-/gi,"")),c},iterate:function(a,b){var c;for(c in a)a.hasOwnProperty(c)&&typeof b=="function"&&b.call(a,a[c],c);return a},loading:function(a){try{var b=e.loading;a=s.object(a);if(a instanceof Array)return a.each(function(a){s.loading(a)});if(b.url===null)throw Error(m.error.elementNotFound);if(typeof a=="undefined")throw Error(m.error.invalidArguments);return typeof b.image=="undefined"&&(b.image=new Image,b.image.src=b.url),a.clear(),a.create("div",{"class":"loading"}).create("img",{alt:m.common.loading,src:b.image.src}),a}catch(c){return v(c,arguments,this),undefined}},log:function(a){try{console.log(a)}catch(b){v(b,arguments,this)}return undefined},merge:function(a,b){return s.iterate(b,function(b,c){a[c]=s.clone(b)}),a},module:function(a,b){try{if(typeof e[a]!="undefined"||typeof abaaso[a]!="undefined"||!b instanceof Object)throw Error(m.error.invalidArguments);return abaaso[a]=b,e[a]={},e.alias(e[a],abaaso[a])}catch(c){return v(c,arguments,this),undefined}},object:function(a){return typeof a=="object"?a:a.toString().charAt(0)==="#"?e(a):a},proto:function(a,b){var c,d={array:{addClass:function(a){return this.each(function(b){b.addClass(a)})},after:function(a,b){var c=[];return this.each(function(d){c.push(d.after(a,b))}),c},append:function(a,b){var c=[];return this.each(function(d){c.push(d.append(a,b))}),c},attr:function(a,b){var c=[];return this.each(function(d){c.push(d.attr(a,b))}),c},before:function(a,b){var c=[];return this.each(function(d){c.push(d.before(a,b))}),c},clear:function(a){return this.each(function(a){a.clear()})},clone:function(){return s.clone(this)},contains:function(a){return f.contains(this,a)},create:function(a,b,c){var d=[];return this.each(function(e){d.push(e.create(a,b,c))}),d},css:function(a,b){return this.each(function(c){c.css(a,b)})},diff:function(a){return f.diff(this,a)},disable:function(){return this.each(function(a){a.disable()})},destroy:function(){return this.each(function(a){a.destroy()}),[]},each:function(a){return f.each(this,a)},enable:function(){return this.each(function(a){a.enable()})},first:function(){return f.first(this)},hasClass:function(a){var b=[];return this.each(function(c){b.push(c.hasClass(a))}),b},hide:function(){return this.each(function(a){a.hide()})},html:function(a){return this.each(function(b){b.html(a)})},index:function(a){return f.index(this,a)},indexed:function(){return f.indexed(this)},intersect:function(a){return f.intersect(this,a)},isAlphaNum:function(){var a=[];return this.each(function(b){a.push(b.isAlphaNum())}),a},isBoolean:function(){var a=[];return this.each(function(b){a.push(b.isBoolean())}),a},isDate:function(){var a=[];return this.each(function(b){a.push(b.isDate())}),a},isDomain:function(){var a=[];return this.each(function(b){a.push(b.isDomain())}),a},isEmail:function(){var a=[];return this.each(function(b){a.push(b.isEmail())}),a},isIP:function(){var a=[];return this.each(function(b){a.push(b.isIP())}),a},isInt:function(){var a=[];return this.each(function(b){a.push(b.isInt())}),a},isNumber:function(){var a=[];return this.each(function(b){a.push(b.isNumber())}),a},isPhone:function(){var a=[];return this.each(function(b){a.push(b.isPhone())}),a},isString:function(){var a=[];return this.each(function(b){a.push(b.isAlphaNum())}),a},keys:function(){return f.keys(this)},last:function(a){return f.last(this)},loading:function(){return this.each(function(a){a.loading()})},on:function(a,b,c,d,e){return this.each(function(f){f.on(a,b,c,typeof d!="undefined"?d:f,e)})},position:function(){var a=[];return this.each(function(b){a.push(b.position())}),a},prepend:function(a,b){var c=[];return this.each(function(d){c.push(d.prepend(a,b))}),c},remove:function(a){return f.remove(this,a)},removeClass:function(a){return this.each(function(b){b.removeClass(a)})},show:function(){return this.each(function(a){a.show()})},size:function(){var a=[];return this.each(function(b){a.push(b.size())}),a},text:function(a){return this.each(function(b){typeof b!="object"&&(b=s.object(b)),typeof b.text=="function"&&b.text(a)})},tpl:function(a){return this.each(function(b){b.tpl(a)})},total:function(){return f.total(this)},toObject:function(){return f.toObject(this)},un:function(a,b,c){return this.each(function(d){d.un(a,b,c)})},update:function(a){return this.each(function(b){k.update(b,a)})},val:function(a){var b=[],c=null,d=!0;return this.each(function(e){c!==null&&(d=c===e.type),c=e.type,b.push(e.val(a))}),d?b[0]:b},validate:function(){var a=[];return this.each(function(b){typeof b.validate=="function"&&a.push(b.validate())}),a}},element:{addClass:function(a){return this.genId(),k.klass(this,a,!0)},after:function(a,b){return this.genId(),k.create(a,b,this,"after")},append:function(a,b){return this.genId(),k.create(a,b,this,"last")},attr:function(a,b){return this.genId(),k.attr(this,a,b)},before:function(a,b){return this.genId(),k.create(a,b,this,"before")},clear:function(){return this.genId(),k.clear(this)},create:function(a,b,c){return this.genId(),k.create(a,b,this,c)},css:function(a,b){var c;return this.genId(),!h.chrome&&(c=a.indexOf("-"))&&c>-1&&(a=a.replace("-",""),a=a.slice(0,c)+a.charAt(c).toUpperCase()+a.slice(c+1,a.length)),this.style[a]=b,this},destroy:function(){return k.destroy(this)},disable:function(){return k.disable(this)},enable:function(){return k.enable(this)},get:function(a,b){this.fire("beforeGet");var c=g.get(a),d=s.guid(!0),e=this;return c?this.html(c.response).fire("afterGet"):a.get(function(a){e.html(a).fire("afterGet")},null,b),this},hasClass:function(a){return this.genId(),k.hasClass(this,a)},hide:function(){return this.genId(),k.hide(this)},html:function(a){return this.genId(),this.update({innerHTML:a})},isAlphaNum:function(){return this.nodeName==="FORM"?!1:t.test({alphanum:typeof this.value!="undefined"?this.value:this.innerText}).pass},isBoolean:function(){return this.nodeName==="FORM"?!1:t.test({"boolean":typeof this.value!="undefined"?this.value:this.innerText}).pass},isDate:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isDate():this.innerText.isDate()},isDomain:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isDomain():this.innerText.isDomain()},isEmail:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isEmail():this.innerText.isEmail()},isEmpty:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isEmpty():this.innerText.isEmpty()},isIP:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isIP():this.innerText.isIP()},isInt:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isInt():this.innerText.isInt()},isNumber:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isNumber():this.innerText.isNumber()},isPhone:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isPhone():this.innerText.isPhone()},isString:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isString():this.innerText.isString()},jsonp:function(a,b,c){var d=this,e=b,f;return f=function(a){var b=d,c=a,f=e,g,h,i;try{typeof f!="undefined"?(f=f.replace(/]|'|"/g,"").replace(/\./g,"[").split("["),f.each(function(a){c=c[isNaN(a)?a:parseInt(a)];if(typeof c=="undefined")throw Error(m.error.propertyNotFound)}),i=c):i=a}catch(j){i=m.error.serverError,v(j,arguments,this)}b.text(i)},h.jsonp(a,f,function(){d.text(m.error.serverError)},c),this},loading:function(){return e.loading.create(this)},on:function(a,b,c,d,f){return this.genId(),e.on.call(this,a,b,c,d,f)},prepend:function(a,b){return this.genId(),k.create(a,b,this,"first")},prependChild:function(a){return this.genId(),k.prependChild(this,a)},position:function(){return this.genId(),k.position(this)},removeClass:function(a){return this.genId(),k.klass(this,a,!1)},show:function(){return this.genId(),k.show(this)},size:function(){return this.genId(),k.size(this)},text:function(a){var b={};return this.genId(),typeof this.value!="undefined"&&(b.value=a),b.innerHTML=a,this.update(b)},tpl:function(a){return e.tpl(a,this)},un:function(a,b,c){return this.genId(),e.un.call(this,a,b,c)},update:function(a){return this.genId(),k.update(this,a)},val:function(a){return this.genId(),k.val(this,a)},validate:function(){return this.nodeName==="FORM"?t.test(this).pass:typeof this.value!="undefined"?!this.value.isEmpty():!this.innerText.isEmpty()}},"function":{reflect:function(){return s.reflect(this)}},number:{diff:function(a){return q.diff.call(this,a)},format:function(a,b){return q.format(this,a,b)},isEven:function(){return q.even(this)},isOdd:function(){return q.odd(this)},on:function(a,b,c,d,f){return e.on.call(this,a,b,c,d,f)},un:function(a,b,c){return e.un.call(this,a,b,c)}},shared:{fire:function(a,b){return this.genId(),e.fire.call(this,a,b)},genId:function(){return s.genId(this)},listeners:function(a){return this.genId(),e.listeners.call(this,a)}},string:{allows:function(a){return e.allows(this,a)},capitalize:function(){return this.charAt(0).toUpperCase()+this.slice(1)},del:function(a,b){return h.request(this,"DELETE",a,b)},explode:function(a){if(typeof a=="undefined"||a.toString()==="")a=",";return this.split(new RegExp("\\s*"+a+"\\s*"))},get:function(a,b,c){return h.request(this,"GET",a,b,c)},isAlphaNum:function(){return t.test({alphanum:this}).pass},isBoolean:function(){return t.test({"boolean":this}).pass},isDate:function(){return t.test({date:this}).pass},isDomain:function(){return t.test({domain:this}).pass},isEmail:function(){return t.test({email:this}).pass},isEmpty:function(){return!t.test({notEmpty:this}).pass},isIP:function(){return t.test({ip:this}).pass},isInt:function(){return t.test({integer:this}).pass},isNumber:function(){return t.test({number:this}).pass},isPhone:function(){return t.test({phone:this}).pass},isString:function(){return t.test({string:this}).pass},jsonp:function(a,b,c){return h.jsonp(this,a,b,c)},post:function(a,b,c){return h.request(this,"POST",a,b,c)},put:function(a,b,c){return h.request(this,"PUT",a,b,c)},on:function(a,b,c,d,f){return e.on.call(this,a,b,c,d,f)},options:function(a,b){return h.request(this,"OPTIONS",a,b)},headers:function(a,b){return h.request(this,"HEAD",a,b)},permissions:function(){return e.permissions(this)},toCamelCase:function(){var a=this.toLowerCase().split(" "),b="",c,d;for(c=0,d=a.length;c<d;c++)b+=c===0?a[c]:String(a[c]).capitalize();return b.replace(/\W/g,"")},trim:function(){return this.replace(/^\s+|\s+$/g,"")},un:function(a,b,c){return e.un.call(this,a,b,c)}}};return s.iterate(d[b],function(b,c){a.prototype[c]=b}),b!=="function"&&s.iterate(d.shared,function(b,c){a.prototype[c]=b}),a},queryString:function(a){a=a||".*";var b={},d=c.search.isEmpty()?null:c.search.replace("?",""),e;return d!==null&&(d=d.split("&"),d.each(function(a){e=a.split("=");if(e[0].isEmpty())return;switch(!0){case typeof e[1]=="undefined":case e[1].isEmpty():e[1]="";break;case e[1].isNumber():e[1]=Number(e[1]);break;case e[1].isBoolean():e[1]=e[1]==="true"}switch(!0){case typeof b[e[0]]=="undefined":b[e[0]]=e[1];break;case!(b[e[0]]instanceof Array):b[e[0]]=[b[e[0]]];default:b[e[0]].push(e[1])}})),b},reflect:function(a){return typeof a=="undefined"&&(a=this),typeof a=="undefined"&&(a=e),a=a.toString().match(/function\s+\w*\s*\((.*?)\)/)[1],a!==""?a.explode():[]},repeat:function(a,b,c){c=c||s.guid(!0);var d=function(a,b,c){var d=this;a()!==!1?e.repeating[c]=setTimeout(function(){d.call(d,a,b,c)},b):delete e.repeating[c]};return d.call(d,a,b,c),c},tpl:function(a,c){try{switch(!0){case typeof a!="object":case!/object|undefined/.test(typeof c)&&typeof (c=c.charAt(0)==="#"?e(c):e(c)[0])=="undefined":throw Error(m.error.invalidArguments)}typeof c=="undefined"&&(c=e("body")[0]);var d=b.createDocumentFragment();switch(!0){case a instanceof Array:a.each(function(a){e.create(f.cast(a,!0)[0],d).html(f.cast(a)[0])});break;default:s.iterate(a,function(a,b){switch(!0){case typeof a=="string":e.create(b,d).html(a);break;case a instanceof Array:case a instanceof Object:e.tpl(a,e.create(b,d))}})}return c.appendChild(d),c}catch(g){return v(g,arguments,this),undefined}}},t={pattern:{alphanum:/^[a-zA-Z0-9]*$/,"boolean":/^(0|1|true|false)?$/,domain:/^[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#])?/,email:/[a-zA-Z0-9.!#$%&'*+-/=?\^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*/,ip:/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.) {3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/,integer:/(^-?\d\d*$)/,notEmpty:/\w{1,}/,number:/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/,phone:/^\([1-9]\d{2}\)\s?\d{3}\-\d{4}$/,string:/\w/},test:function(a){var b=!1,c=[],d=null;if(typeof a.nodeName!="undefined"&&a.nodeName==="FORM"){var f,g,h,i,j,k,l={},m,n,c=[],o={};return a.id.isEmpty()&&a.genId(),i=e("#"+a.id+" > input").concat(e("#"+a.id+" > select")),i.each(function(a){g=t.pattern[a.nodeName.toLowerCase()]?t.pattern[a.nodeName.toLowerCase()]:!a.id.isEmpty()&&t.pattern[a.id.toLowerCase()]?t.pattern[a.id.toLowerCase()]:"notEmpty",h=a.val(),h===null&&(h=""),l[g]=h}),n=this.test(l),n}return s.iterate(a,function(a,f){if(typeof f=="undefined"||typeof a=="undefined"){c.push({test:f,value:a}),b=!0;return}d=a.charAt(0)==="#"?typeof e(a)!="undefined"?e(a).val():"":a;switch(f){case"date":isNaN((new Date(d)).getYear())&&(c.push({test:f,value:d}),b=!0);break;case"domain":t.pattern.domain.test(d.replace(/.*\/\//,""))||(c.push({test:f,value:d}),b=!0);break;case"domainip":if(!t.pattern.domain.test(d.replace(/.*\/\//,""))||!t.pattern.ip.test(d))c.push({test:f,value:d}),b=!0;break;default:var g=typeof t.pattern[f]!="undefined"?t.pattern[f]:f;g.test(d)||(c.push({test:f,value:d}),b=!0)}}),{pass:!b,invalid:c}}},u={decode:function(a){try{if(typeof a!="string"||a.isEmpty())throw Error(m.error.invalidArguments);var b;return h.ie?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml"),b}catch(c){return v(c,arguments,this),undefined}},encode:function(a,b){try{if(typeof a=="undefined")throw Error(m.error.invalidArguments);switch(!0){case a!==null&&typeof a.xml!="undefined":c=a.xml;break;case a instanceof Document:c=(new XMLSerializer).serializeToString(a);break;default:b=b!==!1;var c=b?"<xml>":"",d=arguments[2]===!1?!1:!0,e,f;e=function(a,b){var c="<n>v</n>";return/\&|\<|\>|\"|\'|\t|\r|\n|\@|\$/g.test(b)&&(c=c.replace(/v/,"<![CDATA[v]]>")),c.replace(/n/g,a).replace(/v/,b)};switch(!0){case typeof a=="boolean":case typeof a=="number":case typeof a=="string":c+=e("item",a);break;case typeof a=="object":s.iterate(a,function(a,b){c+=c.encode(a,typeof a=="object",!1).replace(/item|xml/g,isNaN(b)?b:"item")})}c+=b?"</xml>":"",d&&(c='<?xml version="1.0" encoding="UTF8"?>'+c)}return c}catch(g){return v(g,arguments,this),undefined}}},v=s.error,{array:f,callback:{},client:{android:h.android,blackberry:h.blackberry,css3:!1,chrome:h.chrome,expire:h.expire,firefox:h.firefox,ie:h.ie,ios:h.ios,linux:h.linux,mobile:h.mobile,opera:h.opera,osx:h.osx,playbook:h.playbook,safari:h.safari,tablet:h.tablet,size:{x:0,y:0},version:0,webos:h.webos,windows:h.windows,del:function(a,b,c){return h.request(a,"DELETE",b,c)},get:function(a,b,c,d){return h.request(a,"GET",b,c,d)},headers:function(a,b,c){return h.request(a,"HEAD",b,c)},post:function(a,b,c,d){return h.request(a,"POST",b,c,d)},put:function(a,b,c,d){return h.request(a,"PUT",b,c,d)},jsonp:function(a,b,c,d){return h.jsonp(a,b,c,d)},options:function(a,b,c){return h.request(a,"OPTIONS",b,c)},permission:h.permission},cookie:i,data:j,el:k,json:l,label:m,loading:{create:s.loading,url:null},message:o,mouse:p,number:q,observer:{log:r.log,add:r.add,fire:r.fire,fired:0,list:r.list,remove:r.remove},state:{_current:null,header:null,previous:null},validate:t,xml:u,$:s.$,alias:s.alias,aliased:"$",allows:h.allows,append:function(a,b,c){return c instanceof Element&&c.genId(),k.create(a,b,c,"last")},bootstrap:function(){var d=function(a){/complete|loaded/.test(b.readyState)&&(typeof abaaso.timer.init!="undefined"&&(clearInterval(abaaso.timer.init),delete abaaso.timer.init),typeof abaaso.init=="function"&&abaaso.init())};typeof Array.prototype.filter=="undefined"&&(Array.prototype.filter=function(a){"use strict";if(this===void 0||this===null||typeof a!="function")throw Error(m.error.invalidArguments);var b=null,c=Object(this),d=c.length>>>0,e=[],f=arguments[1],g=null;for(b=0;b<d;b++)b in c&&(g=c[b],a.call(f,g,b,c)&&e.push(g));return e}),typeof Array.prototype.forEach=="undefined"&&(Array.prototype.forEach=function(a,b){"use strict";if(this===null||typeof a!="function")throw Error(m.error.invalidArguments);var c,d=0,e=Object(this),f=e.length>>>0;b&&(c=b);while(d<f){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),typeof Function.prototype.bind=="undefined"&&(Function.prototype.bind=function(a){"use strict";var b=this,c=Array.prototype.slice,d=c.call(arguments,1);return function(){return b.apply(a,d.concat(c.call(arguments)))}}),abaaso.client.size=h.size(),h.version(),h.css3(),h.tablet();if(h.ie&&h.version<8)return;e=abaaso.$.bind(e),s.alias(e,abaaso),delete e.$,delete e.bootstrap,delete e.init,delete e.data,e.fire=abaaso.fire,e.on=abaaso.on,e.un=abaaso.un,e.listeners=abaaso.listeners,abaaso.state._current=abaaso.state.current="initial",e.state._current=e.state.current=abaaso.state.current;switch(!0){case a.$===null:a.$=e;break;default:a.a$=e,abaaso.aliased="a$"}s.proto(Array,"array"),typeof Element!="undefined"&&s.proto(Element,"element"),h.ie&&h.version===8&&s.proto(HTMLDocument,"element"),s.proto(Function,"function"),s.proto(Number,"number"),s.proto(String,"string"),abaaso.constructor=abaaso,e.error.log=abaaso.error.log=[],h.server||(e.on(a,"hashchange",function(){e.fire("beforeHash").fire("hash",c.hash).fire("afterHash",c.hash)}),e.on(a,"resize",function(){e.client.size=abaaso.client.size=h.size(),e.fire("resize",abaaso.client.size)}),e.on(a,"load",function(){e.fire("render").un("render")}));var f,g;f=function(){return this._current},g=function(a){try{if(a===null||typeof a!="string"||this.current===a||a.isEmpty())throw Error(m.error.invalidArguments);return abaaso.state.previous=abaaso.state._current,abaaso.state._current=a,r.state(a)}catch(b){return v(b,arguments,this),undefined}};switch(!0){case(!h.ie||h.version>8)&&typeof Object.defineProperty=="function":Object.defineProperty(abaaso.state,"current",{get:f,set:g}),Object.defineProperty(e.state,"current",{get:f,set:g});break;case typeof abaaso.state.__defineGetter__=="function":abaaso.state.__defineGetter__("current",f),abaaso.state.__defineSetter__("current",g),e.state.__defineGetter__("current",f),e.state.__defineSetter__("current",g);break;default:abaaso.state.change=function(a){return abaaso.state.current=a,g.call(abaaso.state,a)},e.state.change=function(a){return abaaso.state.current=a,g.call(abaaso.state,a)}}e.ready=!0;switch(!0){case typeof define=="function":define("abaaso",function(){return abaaso.init()});break;case h.server:case/complete|loaded/.test(b.readyState):abaaso.init();break;case typeof b.addEventListener=="function":b.addEventListener("DOMContentLoaded",abaaso.init,!1);break;case typeof b.attachEvent=="function":b.attachEvent("onreadystatechange",d);break;default:abaaso.timer.init=setInterval(d,10)}},clear:k.clear,clone:s.clone,create:k.create,css:k.css,decode:l.decode,defer:s.defer,define:s.define,del:function(a,b,c){return h.request(a,"DELETE",b,c)},destroy:k.destroy,encode:l.encode,error:s.error,expire:g.clean,expires:12e4,extend:s.extend,fire:function(a,b,c){var d=typeof c!="undefined",f,g,h;f=d?a:this,g=d?b:a,h=d?c:b;if(typeof f=="undefined"||f===e)f=abaaso;return r.fire.call(r,f,g,h)},genId:s.genId,get:function(a,b,c,d){return h.request(a,"GET",b,c,d)},guid:s.guid,headers:function(a,b,c){return h.request(a,"HEAD",b,c)},hidden:k.hidden,id:"abaaso",init:function(){delete abaaso.init,delete abaaso.bootstrap;var a=function(){var a=this;e.timer.expire=setTimeout(function(){g.clean(),a.call(a)},e.expires)};return a.call(a),e.fire("init").un("init").fire("ready").un("ready")},iterate:s.iterate,jsonp:function(a,b,c,d){return h.jsonp(a,b,c,d)},listeners:function(a){var b=this;if(typeof b=="undefined"||b===e)b=abaaso;return r.list.call(r,b,a)},log:s.log,merge:s.merge,module:s.module,on:function(a,b,c,d,f,g){var h=typeof c=="function",i,j,k,l,m,n;i=h?a:this,j=h?b:a,k=h?c:b,l=h?d:c,m=h?f:d,n=h?g:f;if(typeof i=="undefined"||i===e)i=abaaso;return typeof m=="undefined"&&(m=i),r.add.call(r,i,j,k,l,m,n)},options:function(a,b,c){return h.request(a,"OPTIONS",b,c)},permissions:h.permissions,position:k.position,post:function(a,b,c,d){return h.request(a,"POST",b,c,d)},prepend:function(a,b,c){return c instanceof Element&&c.genId(),k.create(a,b,c,"first")},put:function(a,b,c,d){return h.request(a,"PUT",b,c,d)},queryString:s.queryString,ready:!1,reflect:s.reflect,repeat:s.repeat,repeating:{},store:function(a,b){return j.register.call(j,a,b)},timer:{},tpl:s.tpl,un:function(a,b,c,d){var f=typeof c!="undefined",g,h,i,j;g=f?a:this,h=f?b:a,i=f?c:b,j=f?d:c;if(typeof g=="undefined"||g===e)g=abaaso;return r.remove.call(r,g,h,i,j)},update:k.update,version:"1.9.9"}}()),typeof abaaso.bootstrap=="function"&&abaaso.bootstrap()})(this)